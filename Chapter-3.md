# Chapter 3. 블록체인을 지원하는 암호화 기술 이해하기

## Lesson 16. 정보 시스템을 지원하는 현대 암호화 기술

![image-20211219144241132](images/image-20211219144241132.png)

- 평문: 사람이 이해하는 문장.
- 암호문(암호): 암호화한 문장.
- 암호화(Encryption): 사람이 이해하는 문장을 어떤 규칙에 따라 이해하지 못하는 형태로 변환해 비밀을 교환하는 것.
- 복호화(Decryption): 암호문을 평문으로 되돌리는 것.



컴퓨터가 발전하며 현대의 암호화 기술은 과거와 비교해 비밀을 교환하기 위한 도구에서 벗어나 **일상 생활의 안전을 지키는 파수꾼**으로 변하였다. 문서의 비밀 보호만을 목표로하지 않고 다양한 특징을 갖게 되었다.

- 문서 접근 권한을 특정 사람에게만 한정함.
- 문서 내용이 변경되지 않았음을 보장함.
- **문서 작성자의 서명을 검증하거나 증명함.**
- 문서가 어느 시점에 만들어졌는지 증명함.
- 문서에 포함된 내용을 부인하지 못하도록 함.

블록체인은 암호화 기술의 특성을 적절히 이용해 당사자 두 사람 사이뿐만 아니라 **네트워크에 참여하는 모든 사람이 암호화 기술의 장점을 누릴 수 있는 구조**로 되어 있다. 그러므로 블록체인을 제대로 이해하려면 암호화 기술을 이해하는 것이 중요하다.



암호화의 요소에는 `암호 만들기(암호화)`, `암호 풀기(복호화)`, `암호 만들기와 풀기에 사용하는 키` 가 있다. 오래존부터 존재하는 많은 암호화 방식이 있는데, 공통적인 특징은 암호화와 복호화 방법, 암호를 푸는 키를 외부에 알리지 않아야 한다는 점이다.

그러나, **수학 이론을 기반으로하는 컴퓨터가 발전한 이후의 현대 암호화 기술에서는 암호화, 복호화, 키를 만드는 방법 자체는 더 이상 비밀이 아니다. 비밀로 해야하는 부분은 공개된 방법대로 만든 개별 키 자체이다.**

현대 암호화 기술은 `대칭 키 암호(Symmetric Key Cryptography)`와 `공개 키 암호(Public Key Cryptography)` 방식을 사용한다.

![image-20211219225236300](images/image-20211219225236300.png)

**블록체인에서는 공개 키 암호 방식을 많이 사용하며, 특히 다른 공개 키 암호방식보다 키 길이가 짧은 `타원 곡선 암호(Elliptic Curve Cryptography)`를 자주 사용한다.**



## Lesson 17. 특정 사람만이 정보에 접근하는 공개 키 암호

블록체인처럼 여러 참여자가 있는 네트워크에서 특정 사람에게만 문서 접근과 제어 권한을 부여할 때는 '공개 키 암호'가 유용하다. 공개 키로 암호화한 문서는 비밀 키로만 복호화 할 수 있기 때문이다. 즉, **특정 사람만 어떤 작업이 가능한 구조를 만드는 데 적합하다.**

![image-20211219230655675](images/image-20211219230655675.png)

이렇게 공개 키 암호를 사용하면 암호를 푸는 키(비밀 키)를 바꿀 필요가 없다. **그렇지만 공개 키 암호화 방식의 경우 대칭 키 암호 방식과 비교했을 때 계산 시간이 훨씬 오래 걸리기(= 복호화에 오래 걸린다.) 때문에, 용량이 큰 데이터를 암호화할 때 적합하지 않다.**

![image-20211219231750181](images/image-20211219231750181.png)

> HTTPS(SSL/TSL) 등의 경우도 보통 대칭 키 자체를 서로 주고받을 때 공개 키 암호 방식을 사용한다.



블록체인에서는 'RSA' 공개 키 암호화 방식보다 타원 곡선 암호 기반의 타원 곡선 디지털 서명 알고리즘(Elliptic Curve Digital Signature Algorithm, ECDSA)이라는 공개 키 암호를 많이 사용한다.

![image-20211219232051418](images/image-20211219232051418.png)

타원 곡선 디지털 서명 알고리즘의 경우는 RSA와 비교했을 때 상당히 짧은 키만 사용해도 같은 정도의 보안 강도를 유지할 수 있다. 그러므로 발행된 모든 트랜잭션에 전자 서명을 해야하는 블록체인 네트워크에서는 처리 속도가 상대적으로 빠른 타원 곡선 암호가 RSA보다 블록체인에 더 적합하다.



## Lesson 18. 안전한 암호 키를 생성하는 난수 생성법

현대 암호학에서는 암호화에 사용되는 키를 얼마나 안전하게 보호하는지가 중요하다. 또한, 대칭 키 암호나 공개 키 암호 같은 기술과 상관없이 **기반이 되는 키를 생성할 때 (규칙성이 없는) 예측 불가능한 난수를 얻느냐에 따라 안전성이 결정된다.**

![image-20211219233229489](images/image-20211219233229489.png)

진정한 난수는 규칙성이 없으므로 당연히 재연성도 없다. 그러나 컴퓨터는 규칙성이나 재현성이 없는 예측 불가능한 동작을 계속하는 데 매우 서툴다. **컴퓨터가 생성하는 난수는 `유사 난수`라고 한다.** 유사 난수를 만드는 논리를 포함하는 프로그램을 '유사 난수 생성기'라고 한다. '유사'라는 접두어를 사용하는 이유는 실제로 **어떤 함수에 넣은 입력값으로 사람에게는 규칙성이 없는 것처럼 보이는 난수를 만들기 때문이다.** 함수는 같은 값을 입력하면 항상 같은 출력값을 얻는 특성이 있다. **유사 난수 생성기도 함수를 사용하므로 예외 없이 재현성과 예측 가능성이 보장된다.**

유사 난수 생성기에 난수의 씨앗인 '시드'라는 값을 넣으면 난수로 보이는 값을 출력한다. 그러나 유사 난수 생성기는 시드 값이 같으면 항상 같은 난수를 얻는 특징이 있다. 즉, 순수한 난수가 아니므로 '유사'라고 하는 것이다.



암호용 키에 필요한 안전한 난수를 생성하고자 다양한 방법을 사용한다. **사용자의 마우스 커서를 적당히 움직였을 때의 좌표 변화를 시드 값으로 사용한다거나, 스마트폰 터치스크린의 손가락 움직임에 따라 난수를 생성하는 간단한 게임을 준비하거나, 스마트폰의 기울기 정도나 진동의 변화를 바탕으로 시드 값을 생성하는 것** 등이 있다.

> 사람이 직접 임의의 난수를 만들려고 하면 무작위로 보이게 하려는 의식에 사로잡혀 결과적으로는 무작위가 아니게 된다.



## Lesson 19. 디지털 문서의 손상을 감지하는 '단방향 해시 함수'

블록체인 기술의 가장 중요한 개념 중 하나가 `단방향 해시 함수` 이다. 보통은 `단방향` 이라는 용어는 빼고 `해시 함수` 나 `해시` 라고 한다. 해시 함수를 이용한 해싱은 암호화 복호화와 다르게 해싱 함수를 통해 나온 결과를 입력값으로 되돌릴 수 없다.

블록체인 관련 프로젝트에서는 주로 SHA2-256 해시 알고리즘을 사용한다. 해시 함수는 같은 알고리즘을 사용할 때, 같은 값을 넣으면 항상 같은 값을 결과로 얻을 수 있다. 또한 길이가 다른 입력 값을 사용하더라도 항상 일정한 자릿수의 값을 얻는다.

> SHA-256 알고리즘을 이요한 해시 함수는 입력값이 1바이트든, 1메가바이트든, 1기가바이트든 출력값은 항상 64자리의 16진수로 고정된다.